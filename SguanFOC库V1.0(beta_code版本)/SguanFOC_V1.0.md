# SguanFOC库 v1.0
一套专为带传感器永磁同步电机（PMSM）设计的全面磁场定向控制（FOC）实现方案，为初级开发者提供高级电机控制应用的坚实基础，兼顾数学精确性与实际可用性。

## 👨‍💻 作者信息及开源声明
- 邮箱：3464647102@qq.com
- 作者：星必尘Sguan
- 本项目采用 **MIT License** 开源协议，详情请查看 LICENSE 文件。

## 🗂️ 核心数据结构
该库围绕两大核心数据结构构建，统一管理所有FOC操作逻辑：

### `SVPWM_HandleTypeDef`
管理电压变换和PWM生成，实现从d-q坐标到三相输出的完整信号流 [`SguanFOC.h#L11-L33`]：
- **输入**：d-q电压（`u_d`, `u_q`）、转子角度（`theta`）
- **中间量**：α-β电压、三角函数值
- **输出**：三相PWM占空比（`t_a`, `t_b`, `t_c`）
- **反馈**：三相电流及变换后的d-q电流

### `FOC_HandleTypeDef`
包含不同控制策略的所有PID控制器配置 [`SguanFOC.h#L35-L113`]：
- **单环控制器**：位置、速度、电流
- **级联控制器**：位置-速度、速度-电流、位置-速度-电流
- **每个控制器**：Kp、Ki、Kd增益及积分和误差跟踪

## 🌐 多语言支持
该库提供C/Python双重实现选项，适配不同开发场景需求：

| 特性 | C语言 | Python |
|------|-------|--------|
| 性能 | 实时优化 | 快速原型开发 |
| 硬件访问 | 直接寄存器控制 | 高级抽象 |
| 集成 | 嵌入式系统 | 桌面/研究 |
| 内存使用 | 最小 | 较高开销 |

## 🎯 控制模式概述
支持覆盖不同应用需求的全维度控制策略：

### 多种控制模式
- **开环控制**：基本操作的位置和速度模式
- **单环闭环控制**：独立的位置、速度或电流控制
- **级联控制**：
  - 位置-速度双环
  - 速度-电流双环
  - 位置-速度-电流三环

### ⚡ 高级FOC实现
- 7段调制空间矢量PWM（SVPWM）
- 实时性能的快速三角函数近似
- 逆Park和Clarke/Park变换
- 自动编码器对齐和偏移校准

## ✨ 核心技术特性
| 类别 | 特性 |
|------|------|
| 控制算法 | 可配置PID控制器、级联控制系统 |
| 信号处理 | 卡尔曼滤波、低通滤波器、降噪 |
| 数学优化 | 快速sin/cos近似、多项式优化 |
| 硬件集成 | 编码器校准、电流检测、死区补偿 |
| 安全特性 | 输出限制、角度超前补偿、方向控制 |

## 📁 项目结构
```
SguanFOC库V1.0/
├── C语言_库/
│   ├── SguanFOC.h       # 主要头文件
│   ├── SguanFOC.c       # 主要FOC算法实现
│   └── SguanUser_data.h # 硬件抽象层
└── Python库/
    ├── SguanFOC.py      # FOC算法的Python实现
    └── SguanUser_data.py # Python硬件抽象
```

## 🛠️ 硬件要求
- 磁编码器（兼容MT6701）
- 具备三相PWM功能的定时器
- 电流检测ADC通道
- 带死区保护的电机驱动器

## 📚 入门路径
对于初学者，推荐以下学习路径：
1. **从这里开始**：了解库架构和功能
2. **快速入门**：设置你的第一个FOC系统
3. **硬件要求**：验证硬件设置
4. **FOC控制系统结构**：深入架构研究

## 🎯 适用场景
- 机器人关节控制
- 数控机床
- 精密运动系统
- DIY电机控制项目
- 教育性FOC实现

## 🚀 未来规划
本库当前为带传感器FOC应用奠定了坚实基础，后续版本将扩展**无传感器FOC**功能，进一步完善电机控制解决方案。

## 📞 联系我们
如有问题或建议，可通过邮箱 3464647102@qq.com 与作者联系。

### 总结
1. SguanFOC库 v1.0 是面向带传感器PMSM的FOC实现方案，提供C/Python双语言版本，适配嵌入式/桌面开发场景；
2. 核心基于`SVPWM_HandleTypeDef`和`FOC_HandleTypeDef`两大数据结构，支持开环、单环闭环、级联等多类控制模式；
3. 库具备完善的信号处理、数学优化和硬件集成特性，后续将扩展无传感器FOC功能。
